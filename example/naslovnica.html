<html>
<head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="../skulpt_dist/skulpt.min.js" type="text/javascript"></script>
    <script src="../skulpt_dist/skulpt-stdlib.js" type="text/javascript"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.1/css/all.css" integrity="sha384-O8whS3fhG2OnA5Kas0Y9l3cfpmYjapjI0E4theH4iuMD+pLhbf6JI0jIMfYcK3yZ" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/bootstrap.css"/>
    <link type="text/css" rel="stylesheet" href="../css/petlja.css">
</head>

<body>
<div id="mycanvas" class="col-md-offset-4">
</div>
<p>Lorem ipsum</p>

<textarea id="code" rows="24" cols="80">

</textarea>
<pre id="output"></pre>

<script>
    Sk.externalLibraries = {
        pygame: {
            path: '../pygamelib/pygame.js',
        }
    };
    var baseURL = "../pygamelib";
        var pygame_modules = {
        'pygame.display': {
            path: baseURL + '/display.js'
        },
        'pygame.event': {
            path: baseURL + '/event.js'
        },
        'pygame.draw': {
            path: baseURL + '/draw.js'
        },
        'pygame.time': {
            path: baseURL + '/time.js'
        },
        'pygame.image': {
            path: baseURL + '/image.js'
        },
        'pygame.font': {
            path: baseURL + '/font.js'
        },
        'pygame.key': {
            path: baseURL + '/key.js'
        },
        'pygame.version': {
            path: baseURL + '/version.js'
        },
        'pygame.mouse': {
            path: baseURL + '/mouse.js'
        }
    };
    for (var k in pygame_modules) {
        Sk.externalLibraries[k] = pygame_modules[k];
    }
    function printString(text) {
        var output = document.getElementById("output");
        text = text.replace(/</g, '&lt;');
        output.innerHTML = output.innerHTML + text;
    }

    function clearOutput() {
        var output = document.getElementById("output");
        output.innerHTML = '';
    }

    function builtinRead(x) {
        if (Sk.builtinFiles === undefined || Sk.builtinFiles["files"][x] === undefined)
            throw "File not found: '" + x + "'";
        return Sk.builtinFiles["files"][x];
    }

    function runCode() {
        var prog = $("#code").text();
        Sk.misceval.asyncToPromise(function () {
            try {
                return Sk.importMainWithBody("<stdin>", false, prog, true);
            } catch (e) {
                alert(e)
            }
        });
    }

    (Sk.TurtleGraphics || (Sk.TurtleGraphics = {})).target = 'mycanvas';
    Sk.configure({read: builtinRead, output: printString});
    $("#code").load("../pygame_samples/" + window.location.search.substring(1), function () {
        runCode();
    });
</script>
</body>
</html>

